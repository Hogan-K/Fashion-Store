import{_ as S,al as g,ao as F,l as T,m as c,n as u,q as o,w as l,v as e,X as p,aq as h,ap as C,af as k,ar as I,t as n,a8 as V,as as _,b4 as L,a6 as q,b3 as D,y as U,z as B}from"./index-0e68266d.js";import{V as N}from"./VTable-185d45f2.js";import{V as v}from"./VSheet-82b2d424.js";import{V as x}from"./VDialog-521aa9c7.js";import{b as R,c as z,d as j,V as A,e as O}from"./VTextField-30447f82.js";import{V as P,a as w}from"./VRow-b48a3407.js";import{V as Q}from"./forwardRefs-7d2ac543.js";import"./dialog-transition-8013489f.js";import"./VAvatar-01b2c2ea.js";import"./form-b5b6f469.js";/* empty css              */const Y={name:"CARTS",data(){return{dialog:!1,notFindCoupon:!1,coupons_code:"",couponStatus:!1}},methods:{getCarts(){let t=this;t.$store.dispatch("getCarts"),console.log(t.carts)},editProductQTY(t){let a=this;a.DelCart(t.id);let r={product_id:t.product_id,qty:t.qty};g.post("https://vue-course-api.hexschool.io/api/hogankai/cart",{data:r}).then(b=>{console.log(b),a.getCarts()})},DelCart(t){let a=this;a.$store.dispatch("Loading",!0),g.delete(`https://vue-course-api.hexschool.io/api/hogankai/cart/${t}`).then(r=>{console.log(r)}),setTimeout(()=>{a.getCarts()},300),a.$store.dispatch("Loading",!1)},dialogOpen(){this.dialog=!0},chooseCoupons(){let t=this,a={code:t.coupons_code};t.$store.dispatch("Loading",!0),g.post("https://vue-course-api.hexschool.io/api/hogankai/coupon",{data:a}).then(r=>{console.log(r),r.data.success?(t.couponStatus=!0,t.getCarts()):(t.notFindCoupon=!0,t.coupons_code=""),t.$store.dispatch("Loading",!1)})},dialogClose(){let t=this;t.dialog=!1,t.couponStatus=!1,t.coupons_code=""}},computed:{cols(){const{xs:t}=this.$vuetify.display;return t?[12,12]:[9,3]},...F(["carts"])},created(){this.getCarts()}},m=t=>(U("data-v-a482100c"),t=t(),B(),t),E={key:0},G=m(()=>e("thead",null,[e("tr",null,[e("th"),e("th",{width:"10",class:"d-none d-sm-table-cell"}),e("th",{class:"d-none d-sm-table-cell text-subtitle-1 font-weight-bold"},"品名"),e("th",{class:"text-subtitle-1 font-weight-bold"},"數量"),e("th",{class:"text-subtitle-1 font-weight-bold"},"單價"),e("th",{class:"text-subtitle-1 font-weight-bold"})])],-1)),M={class:"d-none d-sm-table-cell"},X={class:"d-none d-sm-table-cell text-8F8681"},$={class:"text-8F8681"},H=["onUpdate:modelValue","onChange"],J={class:"text-8F8681"},K=m(()=>e("td",{colspan:"2",class:"d-none d-sm-table-cell"},null,-1)),W={colspan:"2",class:"text-center"},Z={class:"ml-4 my-2 text-green text-body-2"},tt=m(()=>e("td",null,"總計",-1)),et={key:0},ot={key:1},lt={class:"text-center my-6"},st=m(()=>e("i",{class:"fa-solid fa-circle-exclamation",style:{"font-size":"30px"}},"購物車是空的！",-1));function at(t,a,r,b,d,i){const y=T("RouterLink");return c(),u(k,null,[t.carts.total!==0?(c(),u("div",E,[o(N,{class:"table mt-4 bg-brown-lighten-5"},{default:l(()=>[G,e("tbody",null,[(c(!0),u(k,null,I(t.carts.carts,s=>(c(),u("tr",{key:s.id},[e("td",null,[o(Q,{class:"py-4",src:s.product.imageUrl,width:"90"},null,8,["src"])]),e("td",M,[s.product.origin_price!==s.product.price?(c(),C(V,{key:0,class:"mb-7",color:"green"},{default:l(()=>[n("mdi-tag")]),_:1})):h("",!0)]),e("td",X,_(s.product.title),1),e("td",$,[q(e("input",{type:"number",min:"1",class:"text-center border rounded-lg w-25","onUpdate:modelValue":f=>s.qty=f,onChange:f=>i.editProductQTY(s)},null,40,H),[[D,s.qty]]),n(" / "+_(s.product.unit),1)]),e("td",J,_(t.$filter.currency(s.final_total)),1),e("td",null,[o(p,{"prepend-icon":"mdi-delete",variant:"plain",onClick:f=>i.DelCart(s.id)},null,8,["onClick"])])]))),128))]),e("tfoot",null,[e("tr",null,[K,e("td",W,[e("p",Z,[n(" 已使用 "),o(V,{color:"green",class:"mb-1"},{default:l(()=>[n("mdi-ticket-percent")]),_:1}),n(" 優惠券 ")])]),tt,t.carts.total==t.carts.final_total?(c(),u("td",et,_(t.$filter.currency(t.carts.total)),1)):h("",!0),t.carts.total!==t.carts.final_total?(c(),u("td",ot,_(t.$filter.currency(t.carts.final_total)),1)):h("",!0)])])]),_:1}),e("div",lt,[o(p,{variant:"outlined",onClick:i.dialogOpen},{default:l(()=>[n("選擇優惠券")]),_:1},8,["onClick"]),o(p,{class:"ml-5",color:"green"},{default:l(()=>[o(y,{to:"/confirm-order",class:"text-decoration-none text-white"},{default:l(()=>[n("前往結賬")]),_:1})]),_:1})])])):h("",!0),t.carts.total==0?(c(),C(v,{key:1,"min-height":"600",color:"brown-lighten-5",class:"d-flex justify-center align-center"},{default:l(()=>[st,o(p,{class:"ml-4",color:"green","append-icon":"mdi-arrow-right-bold-outline"},{default:l(()=>[o(y,{to:"/customer_orders",class:"text-decoration-none text-white"},{default:l(()=>[n("前往購物")]),_:1})]),_:1})]),_:1})):h("",!0),o(x,{modelValue:d.dialog,"onUpdate:modelValue":a[1]||(a[1]=s=>d.dialog=s)},{default:l(()=>[o(R,{class:"mx-auto w-75"},{default:l(()=>[o(z,{class:"bg-a67f78 text-white"},{default:l(()=>[n("選擇優惠券")]),_:1}),o(j,null,{default:l(()=>[o(P,null,{default:l(()=>[o(w,{cols:i.cols[0]},{default:l(()=>[o(A,{label:"請輸入優惠券序號",variant:"solo-filled",modelValue:d.coupons_code,"onUpdate:modelValue":a[0]||(a[0]=s=>d.coupons_code=s)},null,8,["modelValue"])]),_:1},8,["cols"]),o(w,{cols:i.cols[1]},{default:l(()=>[o(p,{class:L(["mt-3",{"text-green":d.couponStatus}]),variant:"outlined",onClick:i.chooseCoupons},{default:l(()=>[d.couponStatus?(c(),C(V,{key:0},{default:l(()=>[n("mdi-checkbox-marked-circle")]),_:1})):h("",!0),n(" 套用優惠券 ")]),_:1},8,["onClick","class"])]),_:1},8,["cols"])]),_:1})]),_:1}),o(O,{class:"justify-end"},{default:l(()=>[o(p,{variant:"outlined",onClick:i.dialogClose},{default:l(()=>[n("取消")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(x,{modelValue:d.notFindCoupon,"onUpdate:modelValue":a[2]||(a[2]=s=>d.notFindCoupon=s)},{default:l(()=>[o(v,{width:"600",color:"grey",class:"text-center mx-auto py-3"},{default:l(()=>[n("找不到此優惠券")]),_:1})]),_:1},8,["modelValue"])],64)}const gt=S(Y,[["render",at],["__scopeId","data-v-a482100c"]]);export{gt as default};
