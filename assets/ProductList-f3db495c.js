import{p as ge,aA as De,C as he,a0 as Re,S as Ve,c as x,r as F,R as M,F as xe,b0 as be,q as t,x as z,af as S,b1 as re,ah as Z,b2 as Pe,s as Ue,U as ze,o as Be,h as Ae,a6 as ue,aD as Me,b3 as Ne,j as Le,Q as Te,_ as Ee,al as se,ao as je,m as H,n as G,v as s,w as r,X as U,t as v,ar as He,a7 as Ge,a8 as Oe,b4 as qe,as as O,y as Qe,z as We}from"./index-d27a65bb.js";import{V as Xe}from"./VHover-34a2e44d.js";import{V as Je}from"./VTable-e8cbc4a0.js";import{V as Ke}from"./VPagination-53520b34.js";import{V as de}from"./VDialog-e87126f6.js";import{f as ye,g as _e,u as we,h as $,i as Ce,j as ke,k as Ie,b as ce,c as fe,V as A,e as me,d as Ye}from"./VTextField-1bf6c824.js";import{V as Ze,a as ve}from"./VRow-6d4e9fe6.js";import{f as Fe,I as $e,V as et}from"./forwardRefs-c8ca9d16.js";import{V as tt}from"./VChip-59ec76c8.js";import{V as ie}from"./VDivider-98ae2b11.js";import{V as lt}from"./VCheckbox-2a511880.js";import"./dialog-transition-e92d1505.js";import"./VAvatar-e3b79868.js";import"./form-6926fc67.js";/* empty css              */import"./VCheckboxBtn-9db53f42.js";const at=ge({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,showSize:{type:[Boolean,Number],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(e)},...ye({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:e=>De(e).every(a=>a!=null&&typeof a=="object")},..._e({clearable:!0})},"VFileInput"),ot=he()({name:"VFileInput",inheritAttrs:!1,props:at(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,a){let{attrs:c,emit:g,slots:l}=a;const{t:u}=Re(),o=Ve(e,"modelValue"),{isFocused:b,focus:q,blur:ee}=we(e),Q=x(()=>typeof e.showSize!="boolean"?e.showSize:void 0),W=x(()=>(o.value??[]).reduce((n,d)=>{let{size:i=0}=d;return n+i},0)),N=x(()=>re(W.value,Q.value)),w=x(()=>(o.value??[]).map(n=>{const{name:d="",size:i=0}=n;return e.showSize?`${d} (${re(i,Q.value)})`:d})),X=x(()=>{var d;const n=((d=o.value)==null?void 0:d.length)??0;return e.showSize?u(e.counterSizeString,n,N.value):u(e.counterString,n)}),D=F(),J=F(),h=F(),te=x(()=>b.value||e.active),K=x(()=>["plain","underlined"].includes(e.variant));function L(){var n;h.value!==document.activeElement&&((n=h.value)==null||n.focus()),b.value||q()}function le(n){R(n)}function C(n){g("mousedown:control",n)}function R(n){var d;(d=h.value)==null||d.click(),g("click:control",n)}function T(n){n.stopPropagation(),L(),Z(()=>{o.value=[],Pe(e["onClick:clear"],n)})}return M(o,n=>{(!Array.isArray(n)||!n.length)&&h.value&&(h.value.value="")}),xe(()=>{const n=!!(l.counter||e.counter),d=!!(n||l.details),[i,p]=be(c),[{modelValue:f,...V}]=$.filterProps(e),[B]=Ce(e);return t($,z({ref:D,modelValue:o.value,"onUpdate:modelValue":_=>o.value=_,class:["v-file-input",{"v-text-field--plain-underlined":K.value},e.class],style:e.style,"onClick:prepend":le},i,V,{centerAffix:!K.value,focused:b.value}),{...l,default:_=>{let{id:k,isDisabled:m,isDirty:I,isReadonly:E,isValid:ae}=_;return t(ke,z({ref:J,"prepend-icon":e.prependIcon,onMousedown:C,onClick:R,"onClick:clear":T,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},B,{id:k.value,active:te.value||I.value,dirty:I.value,disabled:m.value,focused:b.value,error:ae.value===!1}),{...l,default:oe=>{var j;let{props:{class:ne,...Y}}=oe;return t(S,null,[t("input",z({ref:h,type:"file",readonly:E.value,disabled:m.value,multiple:e.multiple,name:e.name,onClick:P=>{P.stopPropagation(),E.value&&P.preventDefault(),L()},onChange:P=>{if(!P.target)return;const Se=P.target;o.value=[...Se.files??[]]},onFocus:L,onBlur:ee},Y,p),null),t("div",{class:ne},[!!((j=o.value)!=null&&j.length)&&(l.selection?l.selection({fileNames:w.value,totalBytes:W.value,totalBytesReadable:N.value}):e.chips?w.value.map(P=>t(tt,{key:P,size:"small",color:e.color},{default:()=>[P]})):w.value.join(", "))])])}})},details:d?_=>{var k,m;return t(S,null,[(k=l.details)==null?void 0:k.call(l,_),n&&t(S,null,[t("span",null,null),t(Ie,{active:!!((m=o.value)!=null&&m.length),value:X.value},l.counter)])])}:void 0})}),Fe({},D,J,h)}});const nt=ge({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...ye(),..._e()},"VTextarea"),pe=he()({name:"VTextarea",directives:{Intersect:$e},inheritAttrs:!1,props:nt(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,a){let{attrs:c,emit:g,slots:l}=a;const u=Ve(e,"modelValue"),{isFocused:o,focus:b,blur:q}=we(e),ee=x(()=>typeof e.counterValue=="function"?e.counterValue(u.value):(u.value||"").toString().length),Q=x(()=>{if(c.maxlength)return c.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function W(i,p){var f,V;!e.autofocus||!i||(V=(f=p[0].target)==null?void 0:f.focus)==null||V.call(f)}const N=F(),w=F(),X=Ue(""),D=F(),J=x(()=>e.persistentPlaceholder||o.value||e.active);function h(){var i;D.value!==document.activeElement&&((i=D.value)==null||i.focus()),o.value||b()}function te(i){h(),g("click:control",i)}function K(i){g("mousedown:control",i)}function L(i){i.stopPropagation(),h(),Z(()=>{u.value="",Pe(e["onClick:clear"],i)})}function le(i){var f;const p=i.target;if(u.value=p.value,(f=e.modelModifiers)!=null&&f.trim){const V=[p.selectionStart,p.selectionEnd];Z(()=>{p.selectionStart=V[0],p.selectionEnd=V[1]})}}const C=F(),R=F(+e.rows),T=x(()=>["plain","underlined"].includes(e.variant));ze(()=>{e.autoGrow||(R.value=+e.rows)});function n(){e.autoGrow&&Z(()=>{if(!C.value||!w.value)return;const i=getComputedStyle(C.value),p=getComputedStyle(w.value.$el),f=parseFloat(i.getPropertyValue("--v-field-padding-top"))+parseFloat(i.getPropertyValue("--v-input-padding-top"))+parseFloat(i.getPropertyValue("--v-field-padding-bottom")),V=C.value.scrollHeight,B=parseFloat(i.lineHeight),_=Math.max(parseFloat(e.rows)*B+f,parseFloat(p.getPropertyValue("--v-input-control-height"))),k=parseFloat(e.maxRows)*B+f||1/0,m=Te(V??0,_,k);R.value=Math.floor((m-f)/B),X.value=Le(m)})}Be(n),M(u,n),M(()=>e.rows,n),M(()=>e.maxRows,n),M(()=>e.density,n);let d;return M(C,i=>{i?(d=new ResizeObserver(n),d.observe(C.value)):d==null||d.disconnect()}),Ae(()=>{d==null||d.disconnect()}),xe(()=>{const i=!!(l.counter||e.counter||e.counterValue),p=!!(i||l.details),[f,V]=be(c),[{modelValue:B,..._}]=$.filterProps(e),[k]=Ce(e);return t($,z({ref:N,modelValue:u.value,"onUpdate:modelValue":m=>u.value=m,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-text-field--plain-underlined":T.value},e.class],style:e.style},f,_,{centerAffix:R.value===1&&!T.value,focused:o.value}),{...l,default:m=>{let{isDisabled:I,isDirty:E,isReadonly:ae,isValid:oe}=m;return t(ke,z({ref:w,style:{"--v-textarea-control-height":X.value},onClick:te,onMousedown:K,"onClick:clear":L,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},k,{active:J.value||E.value,centerAffix:R.value===1&&!T.value,dirty:E.value||e.dirty,disabled:I.value,focused:o.value,error:oe.value===!1}),{...l,default:ne=>{let{props:{class:Y,...j}}=ne;return t(S,null,[e.prefix&&t("span",{class:"v-text-field__prefix"},[e.prefix]),ue(t("textarea",z({ref:D,class:Y,value:u.value,onInput:le,autofocus:e.autofocus,readonly:ae.value,disabled:I.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:h,onBlur:q},j,V),null),[[Me("intersect"),{handler:W},null,{once:!0}]]),e.autoGrow&&ue(t("textarea",{class:[Y,"v-textarea__sizer"],id:`${j.id}-sizer`,"onUpdate:modelValue":P=>u.value=P,ref:C,readonly:!0,"aria-hidden":"true"},null),[[Ne,u.value]]),e.suffix&&t("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:p?m=>{var I;return t(S,null,[(I=l.details)==null?void 0:I.call(l,m),i&&t(S,null,[t("span",null,null),t(Ie,{active:e.persistentCounter||o.value,value:ee.value,max:Q.value},l.counter)])])}:void 0})}),Fe({},N,w,D)}}),st={name:"ProductList",data(){return{isLoading:!1,dialog:!1,dialogDel:!1,isNew:!1,tempProduct:{},page:1,ErrImg:!1}},methods:{getProducts(e){this.$store.dispatch("getProducts",e)},openModal(e,a){let c=this;e==!0?(c.tempProduct={},c.isNew=!0):(c.tempProduct=Object.assign({},a),c.isNew=!1),c.dialog=!0},updateProduct(){let e=this,a="post",c="https://vue-course-api.hexschool.io/api/hogankai/admin/product";e.isNew||(c=`https://vue-course-api.hexschool.io/api/hogankai/admin/product/${e.tempProduct.id}`,a="put"),e.tempProduct.price==""&&(e.tempProduct.price=e.tempProduct.origin_price),e.$store.dispatch("Loading",!0),se[a](c,{data:e.tempProduct}).then(g=>{if(console.log(g.data),g.data.success){e.dialog=!1,e.getProducts(),e.$store.dispatch("Loading",!1);let l={status:!0,type:"success",title:"",text:"上傳成功"};e.$store.dispatch("setAlert",l)}else{e.$store.dispatch("Loading",!1);let l={status:!0,type:"warning",title:"red",text:"上傳失敗"};e.$store.dispatch("setAlert",l)}})},openDel(e){let a=this;a.tempProduct=Object.assign({},e),a.dialogDel=!0},DelProduct(){let e=this;e.$store.dispatch("Loading",!0),se.delete(`https://vue-course-api.hexschool.io/api/hogankai/admin/product/${e.tempProduct.id}`).then(a=>{console.log(a.data),e.dialogDel=!1,e.getProducts(e.page),e.$store.dispatch("Loading",!1)})},cancelProduct(){let e=this;e.dialog=!1,e.dialogDel=!1},uploadFile(e){console.log(e.target.files[0]);let a=this,c=e.target.files[0];console.log(c);let g=new FormData;a.isLoading=!0,g.append("file-to-upload",c),se.post("https://vue-course-api.hexschool.io/api/hogankai/admin/upload",g,{headers:{"Content-Type":"multipart/form-data"}}).then(l=>{console.log(l),a.isLoading=!1,l.data.success?(a.tempProduct.imageUrl=l.data.imageUrl,a.ErrImg=!1):a.ErrImg=!0})}},watch:{page(){let e=this;e.getProducts(e.page)}},computed:{cols(){const{sm:e,xs:a}=this.$vuetify.display;return e?[12,12]:a?[12,12]:[4,8]},...je(["products","pagination"])},created(){this.getProducts()}},y=e=>(Qe("data-v-bd9b149b"),e=e(),We(),e),it={class:"text-end mt-4"},ut=y(()=>s("thead",null,[s("tr",null,[s("th",{class:"d-none d-lg-table-cell text-subtitle-1 font-weight-bold"},"分類"),s("th",{class:"text-subtitle-1 font-weight-bold"},"產品名稱"),s("th",{class:"d-none d-sm-table-cell text-subtitle-1 font-weight-bold"},"原價"),s("th",{class:"text-subtitle-1 font-weight-bold"},"售價"),s("th",{class:"d-none d-md-table-cell text-subtitle-1 font-weight-bold"},"是否啟用"),s("th",{class:"text-subtitle-1 font-weight-bold"},"編輯"),s("th",{class:"text-subtitle-1 font-weight-bold"},"刪除")])],-1)),rt={class:"d-none d-lg-table-cell text-8F8681"},dt={class:"text-8F8681"},ct={class:"d-none d-sm-table-cell text-8F8681"},ft={class:"text-8F8681"},mt={class:"d-none d-md-table-cell"},vt={key:0,class:"text-success"},pt={key:1,class:"text-secondary"},gt=y(()=>s("i",{class:"far fa-trash-alt"},null,-1)),ht={class:"text-center"},Vt=y(()=>s("h4",null,"輸入圖片網址",-1)),xt={class:"font-italic text-red"},bt=y(()=>s("h4",null,"標題",-1)),Pt=y(()=>s("h4",null,"分類",-1)),yt=y(()=>s("h4",null,"單位",-1)),_t=y(()=>s("h4",null,"原價",-1)),wt=y(()=>s("h4",null,"售價",-1)),Ct=y(()=>s("h4",null,"產品描述",-1)),kt=y(()=>s("h4",null,"說明內容",-1)),It={class:"text-red"};function Ft(e,a,c,g,l,u){return H(),G(S,null,[s("div",it,[t(Xe,null,{default:r(({isHovering:o,props:b})=>[t(U,z({class:"mr-4 text-8F8681",variant:"outlined"},b,{elevation:o?2:8,onClick:a[0]||(a[0]=q=>u.openModal(!0))}),{default:r(()=>[v(" 建立新的產品 ")]),_:2},1040,["elevation"])]),_:1})]),t(Je,{class:"mt-4 bg-brown-lighten-5"},{default:r(()=>[ut,s("tbody",null,[(H(!0),G(S,null,He(e.products,o=>(H(),G("tr",{key:o.id},[s("td",rt,O(o.category),1),s("td",dt,O(o.title),1),s("td",ct,O(e.$filter.currency(o.origin_price)),1),s("td",ft,O(e.$filter.currency(o.price)),1),s("td",mt,[o.is_enabled?(H(),G("span",vt,"啟用")):(H(),G("span",pt,"未啟用"))]),s("td",null,[t(U,{variant:"outlined",color:"blue",onClick:b=>u.openModal(!1,o)},{default:r(()=>[v("編輯")]),_:2},1032,["onClick"])]),s("td",null,[t(U,{variant:"outlined",color:"red",onClick:b=>u.openDel(o)},{default:r(()=>[gt]),_:2},1032,["onClick"])])]))),128))])]),_:1}),s("div",ht,[t(Ke,{class:"my-4",modelValue:l.page,"onUpdate:modelValue":a[1]||(a[1]=o=>l.page=o),length:e.pagination.total_pages,"total-visible":5},null,8,["modelValue","length"])]),t(de,{modelValue:l.dialog,"onUpdate:modelValue":a[11]||(a[11]=o=>l.dialog=o)},{default:r(()=>[t(ce,{class:"mx-auto w-75"},{default:r(()=>[t(fe,{class:"bg-a67f78 text-white"},{default:r(()=>[v("新增產品")]),_:1}),t(Ze,{class:"pa-6"},{default:r(()=>[t(ve,{cols:u.cols[0]},{default:r(()=>[Vt,t(A,{label:"請輸入圖片網址",variant:"underlined",modelValue:l.tempProduct.imageUrl,"onUpdate:modelValue":a[2]||(a[2]=o=>l.tempProduct.imageUrl=o)},null,8,["modelValue"]),s("h4",null,[v("或 上傳圖片檔案 "),ue(s("span",xt,[t(Oe,null,{default:r(()=>[v("mdi-alert-octagram-outline")]),_:1}),v("格式錯誤")],512),[[Ge,l.ErrImg]])]),t(ot,{label:"請選擇上傳檔案",variant:"underlined",class:qe({"text-red":l.ErrImg}),"prepend-icon":"mdi-file",loading:l.isLoading,onChange:u.uploadFile},null,8,["class","loading","onChange"]),t(et,{src:l.tempProduct.imageUrl,alt:""},null,8,["src"])]),_:1},8,["cols"]),t(ve,{cols:u.cols[1]},{default:r(()=>[bt,t(A,{label:"請輸入產品名稱",variant:"solo-filled",class:"mt-2",modelValue:l.tempProduct.title,"onUpdate:modelValue":a[3]||(a[3]=o=>l.tempProduct.title=o)},null,8,["modelValue"]),Pt,t(A,{label:"請輸入產品類別",variant:"solo-filled",class:"mt-2",modelValue:l.tempProduct.category,"onUpdate:modelValue":a[4]||(a[4]=o=>l.tempProduct.category=o)},null,8,["modelValue"]),yt,t(A,{label:"請輸入單位",variant:"solo-filled",class:"mt-2",modelValue:l.tempProduct.unit,"onUpdate:modelValue":a[5]||(a[5]=o=>l.tempProduct.unit=o)},{default:r(()=>[v("> ")]),_:1},8,["modelValue"]),_t,t(A,{label:"請輸入原價",variant:"solo-filled",class:"mt-2",modelValue:l.tempProduct.origin_price,"onUpdate:modelValue":a[6]||(a[6]=o=>l.tempProduct.origin_price=o)},null,8,["modelValue"]),wt,t(A,{label:"請輸入售價",variant:"solo-filled",class:"mt-2",modelValue:l.tempProduct.price,"onUpdate:modelValue":a[7]||(a[7]=o=>l.tempProduct.price=o)},null,8,["modelValue"]),t(ie,{class:"mb-4"}),Ct,t(pe,{label:"請輸入產品描述",variant:"solo-filled",rows:"2",clearable:"",modelValue:l.tempProduct.description,"onUpdate:modelValue":a[8]||(a[8]=o=>l.tempProduct.description=o)},null,8,["modelValue"]),kt,t(pe,{label:"請輸入產品內容",variant:"solo-filled",rows:"2",clearable:"",modelValue:l.tempProduct.content,"onUpdate:modelValue":a[9]||(a[9]=o=>l.tempProduct.content=o)},null,8,["modelValue"]),t(lt,{label:"是否啟用",modelValue:l.tempProduct.is_enabled,"onUpdate:modelValue":a[10]||(a[10]=o=>l.tempProduct.is_enabled=o),"true-value":1,"false-value":0},null,8,["modelValue"])]),_:1},8,["cols"])]),_:1}),t(ie),t(me,{class:"d-flex justify-end"},{default:r(()=>[t(U,{class:"ma-4",variant:"outlined",onClick:u.cancelProduct},{default:r(()=>[v("取消")]),_:1},8,["onClick"]),t(U,{class:"ma-4",variant:"outlined",onClick:u.updateProduct},{default:r(()=>[v("確定")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(de,{modelValue:l.dialogDel,"onUpdate:modelValue":a[12]||(a[12]=o=>l.dialogDel=o)},{default:r(()=>[t(ce,{class:"mx-auto RWDdialogDel"},{default:r(()=>[t(fe,{class:"bg-a67f78 text-white"},{default:r(()=>[v("刪除產品")]),_:1}),t(Ye,null,{default:r(()=>[v(" 是否刪除 "),s("span",It,O(l.tempProduct.title),1),v(" 商品 ( 刪除後將無法恢復 ) ")]),_:1}),t(ie,{class:"my-4"}),t(me,{class:"justify-end"},{default:r(()=>[t(U,{variant:"outlined",onClick:u.cancelProduct},{default:r(()=>[v("取消")]),_:1},8,["onClick"]),t(U,{variant:"outlined",onClick:u.DelProduct},{default:r(()=>[v("確定")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const qt=Ee(st,[["render",Ft],["__scopeId","data-v-bd9b149b"]]);export{qt as default};
